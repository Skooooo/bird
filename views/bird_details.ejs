<!DOCTYPE html>
<html>

<head>
    <title><%= title %></title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <link rel='stylesheet' href='/stylesheets/style.css'/>
    <script src="/javascripts/chatroom.js"></script>

    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
          integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script
            src="http://maps.googleapis.com/maps/api/js">
    </script>

    <script>
        function initialize() {
            var mapProp = {
                center:new google.maps.LatLng(51.508742,-0.120850),
                zoom:5,
                mapTypeId:google.maps.MapTypeId.ROADMAP
            };
            var map=new google.maps.Map(document.getElementById("map"), mapProp);
        }
        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
</head>


<body onload="init('<%= sighting._id %>','<%= sighting.nickname %>')" >
<%- include('../views/partials/header.ejs') %>
<div class="container mt-3">
    <div class="row">
        <div class="justify-content-start col-6">
            <label for="bird_name" class="col-9">
                <h2>Identification: <%= sighting.identification %>
                    <br>
                    <button onclick="window.location.href='/sighting/<%= sighting._id %>/update'">Update
                        Identification</button>
                </h2>
            </label>
            <img class="col-10" src="<%= sighting.img %>" alt="bird image" style="height: 50vh;">
            <div class="col-11 mt-3 border rounded h-50">
                <div class="chatroom">
                    <div class="header">Chat Room: </div>
<!--                    <div>-->
<!--                        <div id="who_you_are" style="display: inline"></div>, you are in room: <div id="in_room" style="display: inline"></div>-->
<!--                    </div>-->
                    <div id="history" class="boxed"></div>
                    <div id="input" class="bottom">
                        <form onsubmit="return false;" style="width: 100%" id="messageForm" name="messageForm">
<!--                            <p><label for="name"> Your name </label>-->
<!--                                <input type="text" id="name" name="name">-->
<!--                            </p>-->
                            <p>
                                <label> chat: </label>
                                <input type="text" id="chat_input" name="chat_input" style="width: 80%">
                                <button type="submit" id="chat_send" onclick="sendChatText()">Send</button>
                            </p>
                        </form>
                    </div>
                </div>
            </div>

        </div>

        <div class="justify-content-end col-6">
            <div class="card col-12 mt-2">
                <div class="card-body">
                    <h5 class="card-title">Date/Time</h5>
                    <p class="card-text"><%= sighting.dateTimeSeen %></p>
                </div>
            </div>

            <div class="card col-12 mt-2">
                <div class="card-body">
                    <h5 class="card-title">Location</h5>
                    <div class="card-text" id="map" style="height: 350px;"></div>
                    <div class="card-text" id="lat" hidden><%=sighting.location.coordinates[1]%></div>
                    <div class="card-text" id="lng" hidden><%=sighting.location.coordinates[0]%></div>
                    <script src="/javascripts/showMap.js"></script>
                </div>
            </div>

            <div class="card col-12 mt-2">
                <div class="card-body">
                    <h5 class="card-title">Description</h5>
                    <p class="card-text">
                        <% if (sighting.birdInfo) { %>
                    <p><%= sighting.birdInfo.description %></p>
                    <% } else { %>
                        <p>No additional description available.</p>
                    <% } %>
                    </p>
                </div>
            </div>

            <div class="card col-12 mt-2">
                <div class="card-body">
                    <h5 class="card-title">Identification: </h5>
                    <p class="card-text">
                        <% if (sighting.birdInfo) { %>
                    <p><%= sighting.birdInfo.name %></p>
                    <a href="<%= sighting.birdInfo.uri %>">More information</a>
                    <% } else { %>
                        <p>No additional information available.</p>
                    <% } %>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>


<script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAdBS-npR2OeE_5APc2d1tZph55N0TpGfY&callback=initMap&libraries=places">
</script>


<%- include('../views/partials/footer.ejs') %>

</body>

</html>